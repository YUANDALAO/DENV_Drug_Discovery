16:31:10 <INFO> Started REINVENT 4.6.27 (C) AstraZeneca 2017, 2023 on 2025-11-30
16:31:10 <INFO> Command line: /home/august/miniconda3/envs/reinvent4/bin/reinvent experiments/runs/spark_run15test/config.toml
16:31:10 <INFO> Reading run configuration from /home/august/aidd/DENV_Drug_Discovery/experiments/runs/spark_run15test/config.toml using format toml
16:31:10 <INFO> User august on host spark-a92c
16:31:10 <INFO> Python version 3.10.19
16:31:10 <INFO> PyTorch version 2.9.1+cu130, git 5811a8d7da873dd699ff6687092c225caffcf1bb
16:31:10 <INFO> PyTorch compiled with CUDA version 13.0
16:31:10 <INFO> RDKit version 2025.09.1
16:31:10 <INFO> Platform Linux-6.14.0-1013-nvidia-aarch64-with-glibc2.39
16:31:10 <INFO> CUDA driver version 580.95.05
16:31:10 <INFO> Number of PyTorch CUDA devices 1
16:31:10 <WARN> 'use_cuda' is deprecated, use 'device' instead
16:31:10 <INFO> Using CUDA device:0 NVIDIA GB10
16:31:10 <INFO> GPU memory: 83379 MiB free, 122570 MiB total
16:31:10 <INFO> Writing TensorBoard summary to /home/august/aidd/DENV_Drug_Discovery/experiments/runs/spark_run15test/tensorboard
16:31:10 <INFO> Writing JSON config file to /home/august/aidd/DENV_Drug_Discovery/experiments/runs/spark_run15test/_config.json
16:31:10 <INFO> Starting 1 stage of Reinforcement Learning
16:31:10 <INFO> /home/august/aidd/DENV_Drug_Discovery/priors/libinvent.prior has valid hash:
{ 'comments': [],
  'creation_date': 0,
  'date_format': 'UNIX epoch',
  'hash_id': '99944413c8f0b152c2bca0dca31aa6d3',
  'hash_id_format': 'xxhash.xxh3_128_hex 3.4.1',
  'model_id': '558e4fbd038c4b0ba67b03a025e657c4',
  'model_id_format': 'uuid.uuid4 3.10.12',
  'origina_data_source': 'ChEMBL 27',
  'updates': []}
16:31:10 <INFO> Number of network parameters: 23,686,692
16:31:10 <INFO> Network architecture:
Decorator(
  (_encoder): Encoder(
    (_embedding): Sequential(
      (0): Embedding(38, 512)
      (1): Dropout(p=0.2, inplace=False)
    )
    (_rnn): LSTM(512, 512, num_layers=3, batch_first=True, dropout=0.2, bidirectional=True)
  )
  (_decoder): Decoder(
    (_embedding): Sequential(
      (0): Embedding(36, 512)
      (1): Dropout(p=0.2, inplace=False)
    )
    (_rnn): LSTM(512, 512, num_layers=3, batch_first=True, dropout=0.2)
    (_attention): AttentionLayer(
      (_attention_linear): Sequential(
        (0): Linear(in_features=1024, out_features=512, bias=True)
        (1): Tanh()
      )
    )
    (_linear): Linear(in_features=512, out_features=36, bias=True)
  )
)
16:31:11 <INFO> /home/august/aidd/DENV_Drug_Discovery/priors/denv_libinvent_model_v2.model has valid hash:
{ 'comments': ['TL'],
  'creation_date': 0,
  'date_format': 'UNIX epoch',
  'hash_id': '8c58a9592ecea86b5038ff7edda23294',
  'hash_id_format': 'xxhash.xxh3_128_hex 3.5.0',
  'model_id': '558e4fbd038c4b0ba67b03a025e657c4',
  'model_id_format': 'uuid.uuid4 3.10.12',
  'origina_data_source': 'ChEMBL 27',
  'updates': [1760314846.2807481]}
16:31:11 <INFO> Number of network parameters: 23,686,692
16:31:11 <INFO> Network architecture:
Decorator(
  (_encoder): Encoder(
    (_embedding): Sequential(
      (0): Embedding(38, 512)
      (1): Dropout(p=0.2, inplace=False)
    )
    (_rnn): LSTM(512, 512, num_layers=3, batch_first=True, dropout=0.2, bidirectional=True)
  )
  (_decoder): Decoder(
    (_embedding): Sequential(
      (0): Embedding(36, 512)
      (1): Dropout(p=0.2, inplace=False)
    )
    (_rnn): LSTM(512, 512, num_layers=3, batch_first=True, dropout=0.2)
    (_attention): AttentionLayer(
      (_attention_linear): Sequential(
        (0): Linear(in_features=1024, out_features=512, bias=True)
        (1): Tanh()
      )
    )
    (_linear): Linear(in_features=512, out_features=36, bias=True)
  )
)
16:31:11 <INFO> Using generator Libinvent
16:31:11 <INFO> Prior read from priors/libinvent.prior
16:31:11 <INFO> Agent read from priors/denv_libinvent_model_v2.model
16:31:11 <INFO> Input molecules/fragments read from file data/pyrrolidine_dual_aryl_fixed.smi
16:31:11 <INFO> Using reward strategy dap
16:31:11 <INFO> Using diversity filter IdenticalMurckoScaffold
16:31:11 <INFO> Diversity filter memories are retained between stages
16:31:11 <INFO> Registered scoring component ROCSSimilarity
16:31:11 <INFO> Registered scoring component GroupCount
16:31:11 <INFO> Registered scoring component FragmentQed
16:31:11 <INFO> Registered scoring component FragmentSlogP
16:31:11 <INFO> Registered scoring component FragmentMolecularWeight
16:31:11 <INFO> Registered scoring component FragmentTPSA
16:31:11 <INFO> Registered scoring component FragmentDistanceMatrix
16:31:11 <INFO> Registered scoring component FragmentNumAtomStereoCenters
16:31:11 <INFO> Registered scoring component FragmentHBondAcceptors
16:31:11 <INFO> Registered scoring component FragmentHBondDonors
16:31:11 <INFO> Registered scoring component FragmentNumRotBond
16:31:11 <INFO> Registered scoring component FragmentCsp3
16:31:11 <INFO> Registered scoring component Fragmentnumsp
16:31:11 <INFO> Registered scoring component Fragmentnumsp2
16:31:11 <INFO> Registered scoring component Fragmentnumsp3
16:31:11 <INFO> Registered scoring component FragmentEffectiveLength
16:31:11 <INFO> Registered scoring component FragmentGraphLength
16:31:11 <INFO> Registered scoring component FragmentLengthRatio
16:31:11 <INFO> Registered scoring component FragmentNumHeavyAtoms
16:31:11 <INFO> Registered scoring component FragmentNumHeteroAtoms
16:31:11 <INFO> Registered scoring component FragmentNumRings
16:31:11 <INFO> Registered scoring component FragmentNumAromaticRings
16:31:11 <INFO> Registered scoring component FragmentNumAliphaticRings
16:31:11 <INFO> Registered scoring component FragmentSlogP
16:31:11 <INFO> Registered scoring component MatchingSubstructure
16:31:11 <INFO> Registered scoring component MolVolume
16:31:11 <INFO> Registered scoring component Qed
16:31:11 <INFO> Registered scoring component LargestRingSize
16:31:11 <INFO> Registered scoring component MolecularWeight
16:31:11 <INFO> Registered scoring component GraphLength
16:31:11 <INFO> Registered scoring component NumAtomStereoCenters
16:31:11 <INFO> Registered scoring component HBondAcceptors
16:31:11 <INFO> Registered scoring component HBondDonors
16:31:11 <INFO> Registered scoring component NumRotBond
16:31:11 <INFO> Registered scoring component Csp3
16:31:11 <INFO> Registered scoring component numsp
16:31:11 <INFO> Registered scoring component numsp2
16:31:11 <INFO> Registered scoring component numsp3
16:31:11 <INFO> Registered scoring component NumHeavyAtoms
16:31:11 <INFO> Registered scoring component NumHeteroAtoms
16:31:11 <INFO> Registered scoring component NumRings
16:31:11 <INFO> Registered scoring component NumAromaticRings
16:31:11 <INFO> Registered scoring component NumAliphaticRings
16:31:11 <INFO> Registered scoring component SlogP
16:31:11 <INFO> Registered scoring component LargestRingSize
16:31:11 <INFO> Registered scoring component PMI
16:31:11 <INFO> Registered scoring component RDKitDescriptors
16:31:11 <INFO> Registered scoring component TanimotoSimilarity
16:31:11 <INFO> Registered scoring component TanimotoDistance
16:31:11 <INFO> Registered scoring component TPSA
16:31:11 <INFO> Registered scoring component SAScore
16:31:11 <INFO> Registered scoring component Cazp
16:31:11 <INFO> Registered scoring component ChemProp
16:31:11 <INFO> Registered scoring component CustomAlerts
16:31:11 <INFO> Registered scoring component DockStream
16:31:11 <INFO> Registered scoring component ExternalProcess
16:31:11 <INFO> Registered scoring component REST
16:31:11 <INFO> Registered scoring component Icolos
16:31:11 <INFO> Registered scoring component Maize
16:31:11 <INFO> Registered scoring component MMP
16:31:11 <INFO> Registered scoring component Qptuna
16:31:11 <INFO> Registered scoring component QSARScorer
16:31:11 <INFO> Registered scoring component ReactionFilter
16:31:11 <INFO> Registered scoring component ScaffoldMatcher
16:31:11 <INFO> Registered scoring component RingPrecedence
16:31:11 <INFO> Creating scoring component QSAR_scorer
16:31:11 <INFO> Creating scoring component NumAtomStereoCenters
16:31:11 <INFO> Creating filter component CustomAlerts
16:31:11 <INFO> Creating scoring component Qed
16:31:11 <INFO> Creating scoring component SAScore
16:31:11 <INFO> Creating scoring component MolecularWeight
16:31:11 <INFO> Creating scoring component NumHeavyAtoms
16:31:11 <INFO> Creating scoring component SlogP
16:31:11 <INFO> Creating scoring component TPSA
16:31:11 <INFO> Creating scoring component HBondAcceptors
16:31:11 <INFO> Creating scoring component HBondDonors
16:31:11 <INFO> Creating scoring component NumRotBond
16:31:11 <INFO> Creating scoring component NumRings
16:31:11 <INFO> Creating scoring component NumAromaticRings
Skipping invalid template CN1CCN(CC1)c2
16:31:11 <INFO> Creating filter component CustomAlerts
16:31:11 <INFO> Creating filter component CustomAlerts
16:31:11 <INFO> Creating filter component CustomAlerts
16:31:11 <INFO> Writing tabular data for stage to experiments/runs/spark_run15test/results_1.csv
16:31:11 <INFO> Starting stage 1 <<<
16:31:11 <INFO> Current GPU memory usage: 40366 MiB used, 82204 MiB free
16:31:11 <CRIT> Received exception ('* is not supported! Supported tokens are ['<pad>', '$', '^', '#', '(', ')', '-', '1', '2', '3', '4', '5', '6', '7', '8', '9', '=', 'Br', 'C', 'Cl', 'F', 'N', 'O', 'S', '[*]', '[N+]', '[N-]', '[N]', '[O-]', '[O]', '[S+]', '[n+]', '[nH]', '[s+]', 'c', 'n', 'o', 's'].'): saving checkpoint and then terminate
[QSAR Scorer] âœ“ Model loaded from models/random_forest_champion.joblib
Traceback (most recent call last):
  File "/home/august/miniconda3/envs/reinvent4/bin/reinvent", line 7, in <module>
    sys.exit(main_script())
  File "/home/august/aidd/DENV_Drug_Discovery/reinvent/Reinvent.py", line 194, in main_script
    main(args)
  File "/home/august/aidd/DENV_Drug_Discovery/reinvent/Reinvent.py", line 163, in main
    runner(
  File "/home/august/aidd/DENV_Drug_Discovery/reinvent/runmodes/RL/run_staged_learning.py", line 366, in run_staged_learning
    terminate = optimize(package.terminator)
  File "/home/august/aidd/DENV_Drug_Discovery/reinvent/runmodes/RL/learning.py", line 129, in optimize
    self.sampled = self.sampling_model.sample(self.seed_smilies)
  File "/home/august/aidd/DENV_Drug_Discovery/reinvent/runmodes/samplers/libinvent.py", line 45, in sample
    dataset = Dataset(
  File "/home/august/aidd/DENV_Drug_Discovery/reinvent/models/libinvent/models/dataset.py", line 24, in __init__
    enc = self._vocabulary.encode(tokenized)
  File "/home/august/aidd/DENV_Drug_Discovery/reinvent/models/libinvent/models/vocabulary.py", line 106, in encode
    raise KeyError(f"{token} is not supported! Supported tokens are {self.tokens()}.")
KeyError: "* is not supported! Supported tokens are ['<pad>', '$', '^', '#', '(', ')', '-', '1', '2', '3', '4', '5', '6', '7', '8', '9', '=', 'Br', 'C', 'Cl', 'F', 'N', 'O', 'S', '[*]', '[N+]', '[N-]', '[N]', '[O-]', '[O]', '[S+]', '[n+]', '[nH]', '[s+]', 'c', 'n', 'o', 's']."
