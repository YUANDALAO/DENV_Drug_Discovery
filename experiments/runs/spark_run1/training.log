11:22:44 <INFO> Started REINVENT 4.7.15 (C) AstraZeneca 2017, 2023 on 2025-11-29
11:22:44 <INFO> Command line: /home/august/miniconda3/envs/reinvent4/bin/reinvent experiments/runs/spark_run1/config.toml
11:22:44 <INFO> Reading run configuration from /home/august/aidd/DENV_Drug_Discovery/experiments/runs/spark_run1/config.toml using format toml
11:22:44 <INFO> User august on host spark-a92c
11:22:44 <INFO> Python version 3.10.19
11:22:44 <INFO> PyTorch version 2.9.1+cu130, git 5811a8d7da873dd699ff6687092c225caffcf1bb
11:22:44 <INFO> PyTorch compiled with CUDA version 13.0
11:22:44 <INFO> RDKit version 2025.09.1
11:22:44 <INFO> Platform Linux-6.14.0-1013-nvidia-aarch64-with-glibc2.39
11:22:44 <INFO> CUDA driver version 580.95.05
11:22:44 <INFO> Number of PyTorch CUDA devices 1
11:22:44 <WARN> 'use_cuda' is deprecated, use 'device' instead
11:22:44 <INFO> Using GPU device:0 NVIDIA GB10
11:22:44 <INFO> GPU memory: 84072 MiB free, 122570 MiB total
11:22:44 <INFO> Writing TensorBoard summary to /home/august/aidd/DENV_Drug_Discovery/experiments/runs/spark_run1/tensorboard
11:22:44 <INFO> Writing JSON config file to /home/august/aidd/DENV_Drug_Discovery/experiments/runs/spark_run1/_config.json
11:22:44 <INFO> Starting 1 stage of Reinforcement Learning
11:22:45 <INFO> /home/august/aidd/DENV_Drug_Discovery/priors/libinvent.prior has valid hash:
{ 'comments': [],
  'creation_date': 0,
  'date_format': 'UNIX epoch',
  'hash_id': '99944413c8f0b152c2bca0dca31aa6d3',
  'hash_id_format': 'xxhash.xxh3_128_hex 3.4.1',
  'model_id': '558e4fbd038c4b0ba67b03a025e657c4',
  'model_id_format': 'uuid.uuid4 3.10.12',
  'origina_data_source': 'ChEMBL 27',
  'updates': []}
11:22:45 <INFO> Number of network parameters: 23,686,692
11:22:45 <INFO> Network architecture:
Decorator(
  (_encoder): Encoder(
    (_embedding): Sequential(
      (0): Embedding(38, 512)
      (1): Dropout(p=0.2, inplace=False)
    )
    (_rnn): LSTM(512, 512, num_layers=3, batch_first=True, dropout=0.2, bidirectional=True)
  )
  (_decoder): Decoder(
    (_embedding): Sequential(
      (0): Embedding(36, 512)
      (1): Dropout(p=0.2, inplace=False)
    )
    (_rnn): LSTM(512, 512, num_layers=3, batch_first=True, dropout=0.2)
    (_attention): AttentionLayer(
      (_attention_linear): Sequential(
        (0): Linear(in_features=1024, out_features=512, bias=True)
        (1): Tanh()
      )
    )
    (_linear): Linear(in_features=512, out_features=36, bias=True)
  )
)
11:22:45 <INFO> /home/august/aidd/DENV_Drug_Discovery/priors/denv_libinvent_model_v2.model has valid hash:
{ 'comments': ['TL'],
  'creation_date': 0,
  'date_format': 'UNIX epoch',
  'hash_id': '8c58a9592ecea86b5038ff7edda23294',
  'hash_id_format': 'xxhash.xxh3_128_hex 3.5.0',
  'model_id': '558e4fbd038c4b0ba67b03a025e657c4',
  'model_id_format': 'uuid.uuid4 3.10.12',
  'origina_data_source': 'ChEMBL 27',
  'updates': [1760314846.2807481]}
11:22:45 <INFO> Number of network parameters: 23,686,692
11:22:45 <INFO> Network architecture:
Decorator(
  (_encoder): Encoder(
    (_embedding): Sequential(
      (0): Embedding(38, 512)
      (1): Dropout(p=0.2, inplace=False)
    )
    (_rnn): LSTM(512, 512, num_layers=3, batch_first=True, dropout=0.2, bidirectional=True)
  )
  (_decoder): Decoder(
    (_embedding): Sequential(
      (0): Embedding(36, 512)
      (1): Dropout(p=0.2, inplace=False)
    )
    (_rnn): LSTM(512, 512, num_layers=3, batch_first=True, dropout=0.2)
    (_attention): AttentionLayer(
      (_attention_linear): Sequential(
        (0): Linear(in_features=1024, out_features=512, bias=True)
        (1): Tanh()
      )
    )
    (_linear): Linear(in_features=512, out_features=36, bias=True)
  )
)
11:22:45 <INFO> Using generator Libinvent
11:22:45 <INFO> Prior read from priors/libinvent.prior
11:22:45 <INFO> Agent read from priors/denv_libinvent_model_v2.model
11:22:45 <INFO> Input molecules/fragments read from file data/pyrrolidine_dual_aryl_fixed.smi
11:22:45 <INFO> Using reward strategy dap
11:22:45 <INFO> Using diversity filter IdenticalMurckoScaffold
11:22:45 <INFO> Diversity filter memories are retained between stages
11:22:45 <INFO> No SMILES for inception. Populating from first sampled batch.
11:22:45 <INFO> Using inception memory
11:22:45 <INFO> Registered scoring component ROCSSimilarity
11:22:45 <INFO> Registered scoring component GroupCount
11:22:45 <INFO> Registered scoring component FragmentQed
11:22:45 <INFO> Registered scoring component FragmentSlogP
11:22:45 <INFO> Registered scoring component FragmentMolecularWeight
11:22:45 <INFO> Registered scoring component FragmentTPSA
11:22:45 <INFO> Registered scoring component FragmentDistanceMatrix
11:22:45 <INFO> Registered scoring component FragmentNumAtomStereoCenters
11:22:45 <INFO> Registered scoring component FragmentHBondAcceptors
11:22:45 <INFO> Registered scoring component FragmentHBondDonors
11:22:45 <INFO> Registered scoring component FragmentNumRotBond
11:22:45 <INFO> Registered scoring component FragmentCsp3
11:22:45 <INFO> Registered scoring component Fragmentnumsp
11:22:45 <INFO> Registered scoring component Fragmentnumsp2
11:22:45 <INFO> Registered scoring component Fragmentnumsp3
11:22:45 <INFO> Registered scoring component FragmentEffectiveLength
11:22:45 <INFO> Registered scoring component FragmentGraphLength
11:22:45 <INFO> Registered scoring component FragmentLengthRatio
11:22:45 <INFO> Registered scoring component FragmentNumHeavyAtoms
11:22:45 <INFO> Registered scoring component FragmentNumHeteroAtoms
11:22:45 <INFO> Registered scoring component FragmentNumRings
11:22:45 <INFO> Registered scoring component FragmentNumAromaticRings
11:22:45 <INFO> Registered scoring component FragmentNumAliphaticRings
11:22:45 <INFO> Registered scoring component FragmentSlogP
11:22:45 <INFO> Registered scoring component MatchingSubstructure
11:22:45 <INFO> Registered scoring component MolVolume
11:22:45 <INFO> Registered scoring component Qed
11:22:45 <INFO> Registered scoring component LargestRingSize
11:22:45 <INFO> Registered scoring component MolecularWeight
11:22:45 <INFO> Registered scoring component GraphLength
11:22:45 <INFO> Registered scoring component NumAtomStereoCenters
11:22:45 <INFO> Registered scoring component HBondAcceptors
11:22:45 <INFO> Registered scoring component HBondDonors
11:22:45 <INFO> Registered scoring component NumRotBond
11:22:45 <INFO> Registered scoring component Csp3
11:22:45 <INFO> Registered scoring component numsp
11:22:45 <INFO> Registered scoring component numsp2
11:22:45 <INFO> Registered scoring component numsp3
11:22:45 <INFO> Registered scoring component NumHeavyAtoms
11:22:45 <INFO> Registered scoring component NumHeteroAtoms
11:22:45 <INFO> Registered scoring component NumRings
11:22:45 <INFO> Registered scoring component NumAromaticRings
11:22:45 <INFO> Registered scoring component NumAliphaticRings
11:22:45 <INFO> Registered scoring component SlogP
11:22:45 <INFO> Registered scoring component LargestRingSize
11:22:45 <INFO> Registered scoring component PMI
11:22:45 <INFO> Registered scoring component RDKitDescriptors
11:22:45 <INFO> Registered scoring component TanimotoSimilarity
11:22:45 <INFO> Registered scoring component TanimotoDistance
11:22:45 <INFO> Registered scoring component TPSA
11:22:45 <INFO> Registered scoring component SAScore
11:22:45 <INFO> Registered scoring component ChemProp
11:22:45 <INFO> Registered scoring component CustomAlerts
11:22:45 <INFO> Registered scoring component DockStream
11:22:45 <INFO> Registered scoring component ExternalProcess
11:22:45 <INFO> Registered scoring component REST
11:22:45 <INFO> Registered scoring component Icolos
11:22:45 <INFO> Registered scoring component MMP
11:22:45 <INFO> Registered scoring component Qptuna
11:22:45 <INFO> Registered scoring component QSARScorer
11:22:45 <INFO> Registered scoring component ReactionFilter
11:22:45 <INFO> Registered scoring component RingPrecedence
11:22:45 <INFO> Registered scoring component Maize
11:22:45 <INFO> Registered scoring component SynthSense
11:22:45 <INFO> Registered scoring component CAZP
11:22:45 <INFO> Creating scoring component QSAR_scorer
11:22:45 <INFO> Creating scoring component NumAtomStereoCenters
11:22:45 <INFO> Creating filter component CustomAlerts
11:22:45 <INFO> Creating scoring component Qed
11:22:45 <INFO> Creating scoring component SAScore
11:22:45 <INFO> Creating scoring component MolecularWeight
11:22:45 <INFO> Creating scoring component NumHeavyAtoms
11:22:45 <INFO> Creating scoring component SlogP
11:22:45 <INFO> Creating scoring component TPSA
11:22:45 <INFO> Creating scoring component HBondAcceptors
11:22:45 <INFO> Creating scoring component HBondDonors
11:22:45 <INFO> Creating scoring component NumRotBond
11:22:45 <INFO> Creating scoring component NumRings
11:22:45 <INFO> Creating scoring component NumAromaticRings
Skipping invalid template CN1CCN(CC1)c2
11:22:45 <INFO> Creating filter component CustomAlerts
11:22:45 <INFO> Creating filter component CustomAlerts
11:22:45 <INFO> Creating filter component CustomAlerts
11:22:45 <INFO> Writing tabular data for stage to experiments/runs/spark_run1/results_1.csv
11:22:45 <INFO> Starting stage 1 <<<
11:22:45 <INFO> Current GPU memory usage: 39644 MiB used, 82926 MiB free
11:22:45 <CRIT> Received exception ('* is not supported! Supported tokens are ['<pad>', '$', '^', '#', '(', ')', '-', '1', '2', '3', '4', '5', '6', '7', '8', '9', '=', 'Br', 'C', 'Cl', 'F', 'N', 'O', 'S', '[*]', '[N+]', '[N-]', '[N]', '[O-]', '[O]', '[S+]', '[n+]', '[nH]', '[s+]', 'c', 'n', 'o', 's'].'): saving checkpoint and then terminate
[QSAR Scorer] âœ“ Model loaded from models/random_forest_champion.joblib
Traceback (most recent call last):
  File "/home/august/miniconda3/envs/reinvent4/bin/reinvent", line 7, in <module>
    sys.exit(main_script())
  File "/home/august/miniconda3/envs/reinvent4/lib/python3.10/site-packages/reinvent/Reinvent.py", line 196, in main_script
    main(args)
  File "/home/august/miniconda3/envs/reinvent4/lib/python3.10/site-packages/reinvent/Reinvent.py", line 165, in main
    runner(
  File "/home/august/miniconda3/envs/reinvent4/lib/python3.10/site-packages/reinvent/runmodes/RL/run_staged_learning.py", line 204, in run_staged_learning
    terminate = optimize(package.terminator)
  File "/home/august/miniconda3/envs/reinvent4/lib/python3.10/site-packages/reinvent/runmodes/RL/learning.py", line 133, in optimize
    self.sampled = self.sampling_model.sample(self.input_smilies)
  File "/home/august/miniconda3/envs/reinvent4/lib/python3.10/site-packages/reinvent/runmodes/samplers/libinvent.py", line 45, in sample
    dataset = Dataset(
  File "/home/august/miniconda3/envs/reinvent4/lib/python3.10/site-packages/reinvent/models/libinvent/models/dataset.py", line 24, in __init__
    enc = self._vocabulary.encode(tokenized)
  File "/home/august/miniconda3/envs/reinvent4/lib/python3.10/site-packages/reinvent/models/libinvent/models/vocabulary.py", line 106, in encode
    raise KeyError(f"{token} is not supported! Supported tokens are {self.tokens()}.")
KeyError: "* is not supported! Supported tokens are ['<pad>', '$', '^', '#', '(', ')', '-', '1', '2', '3', '4', '5', '6', '7', '8', '9', '=', 'Br', 'C', 'Cl', 'F', 'N', 'O', 'S', '[*]', '[N+]', '[N-]', '[N]', '[O-]', '[O]', '[S+]', '[n+]', '[nH]', '[s+]', 'c', 'n', 'o', 's']."
